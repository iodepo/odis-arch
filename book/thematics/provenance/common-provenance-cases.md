# What is provenance?

Fundamentally, the provenance of a thing tells you where that thing came from. 

For example, real [Parmesan cheese]([url](https://en.wikipedia.org/wiki/Parmesan)) is produced in one of the provinces of Parma, Reggio Emilia, Emilia-Romagna, and parts of Mantua. That _should_ be its provenance. Thanks to the protected designations of origin (PDO) regulations in the European Union, one knows the provenance of Parmesan and Parmigiano Reggiano produced/sold in countries subject to those rules (indicated on the packaging). However, outside that regulatory environment, your Parmesan cheese can be of different or unknown provenance, with implications for its quality, authenticity, etc. Handling provenance in digital systems isn't all that different.

For datasets, documents, software, products, or anything else described by the JSON-LD/schema.org records flowing through ODIS, it's vital to indicate the provenance of the the things described. Who authored the paper? What sample was used to generate a dataset? Who or what manufactured a product? 

In this section, we provide guidelines on 1) how to express the basic provenance of a thing and 2) how to add context to that basic provenance to increase reusability, reproducibility, and add value to a digital asset.

# Basic provenance chains

The most basic provenance chain is a very short one: it should tell you where some "Thing" you're interest in originally came from. For example:
* Dataset "T363" was generated by a Temp-O-Matic Sea Surface Temperature sensor.
* Document "Guide to sampling sea salps" was published by Salps & Salps Publishing House.
* Sensor "Temp-O-Matic Sea Surface Temperature" was manufactured by "O-Matic Inc".

A (very) minimal JSON-LD/schema.org representation of the Dataset example above would need a JSON record about the dataset, and another JSON record about the Action that created it:

```json
{
    "@context": {
        "@vocab": "https://schema.org/"
    },
    "@type": "Dataset",
    "@id": "https://registry.org/permanentUrlToThisJsonDoc/T363.json",
    "name": "Dummy temperature dataset",
    "identifier": "T363"
}

```

```json
{
   "@context": {
        "@vocab": "https://schema.org/"
    },
    "@type": "CreateAction",
    "@id": "https://registry.org/permanentUrlToThisJsonDoc/Creation-of-T363.json",
    "name": "Temperature measurement M363",
    "identifier": "M363",
    "actionStatus": "CompletedActionStatus",
    "instrument": "Temp-O-Matic Sea Surface Temperature sensor"
    "result": {
        "@type": "Dataset",
        "@id": "https://registry.org/permanentUrlToThisJsonDoc/T363.json"
     }
}

```

These two JSON records express that a dataset called "Dummy temperature dataset" with identifier "T363" was created by some completed action (with identifier M363) using a "Temp-O-Matic Sea Surface Temperatur sensor" as an instrument. The [result](https://schema.org/result) property in the Action links the Dataset to the Action. The `@id` JSON keyword saves us some typing, as it would expand to everything in the Dataset record (assuming both records are available on the Web). 

Let's try a minimal example for the document example. We could, as we did for dataset, talk about the CreateAction for the document, but since we're talking about the publisher as the "origin" of the document, we can be more compact:

```json
{
    "@context": {
        "@vocab": "https://schema.org/"
    },
    "@type": "Document",
    "@id": "https://registry.org/permanentUrlToThisJsonDoc",
    "name": "Guide to sampling sea salps",
    "identifier": "978-1-56619-909-4",
     "publisher": {
        "@type": "Organization",
        "name": "Salps & Salps Publishing House",
        "address": "Salp street 32, Salpsville 42622, Republic of Salpia"
        }
}
```

Let's try a minimal example for the sensor, in which we use the schema.org [Product](https://schema.org/Product) type (useful for all manufactured products). As before, we could include a CreateAction and use properties from Action, but we can be more compact using the [manufacturer](https://schema.org/manufacturer) property:

```json
{
    "@context": {
        "@vocab": "https://schema.org/"
    },
    "@type": "Product",
    "@id": "https://registry.org/permanentUrlToThisJsonDoc",
    "name": "Temp-O-Matic Sea Surface Temperature",
    "identifier": "978-1-56619-909-4",
     "manufacturer": {
        "@type": "Organization",
        "name": "O-Matic Inc",
        "address": "O-Matic alley 3-6, Matictown 4367, Duchy of O-Matica"
        }
}
```


These most basic chains are useful, but are rarely sufficient. Most people (or other agents) usually need more information to confidently understand how to approach and interact with the Thing you're interested in. A more useful basic provenance chain would include:
* Information about the event (planned or unplanned) that created the Thing you're interested in, or something that it was derived from, including:
  * Who or what was involved in the event
  * What actions were performed that impacted or influenced the Thing or its precursor(s)
  * How those actions impacted that Thing or its precursor(s)
* Information about any subsequent events that changed or influenced the Thing you're interested in or its precursor(s)
* Basic contextual information about those events and the Thing you're interested in or its precursor(s). This will vary from Thing to Thing. For example:
  * The weather or other key environmental conditions at the time of sampling
  * Any known sources of error or bias

In the next sections, we'll demonstrate how to go about the above, nothing how this aligns with the well-known and widely used PROV model for provenance tracking.

# The PROV model

The [PROV Model](https://dvcs.w3.org/hg/prov/raw-file/default/model/working-copy/prov-dm-issue-450.html) is a widely 

At the time of writing, the 2013 specification of [PROV Model](http://www.w3.org/TR/2013/REC-prov-dm-20130430/) is the most current. A permalink to the latest version is available [here](http://www.w3.org/TR/prov-dm/).

If there are semantics/properties that are not expressible in schema.org, then semantics/terms from the PROV-O ontology can be used. **However, this should be done only when absolutely necessary**, as this introduces another semantic context and can reduce interoperability (i.e. speaking two languages in the same conversation unnecessarily).

The central PROV terms (known as [Starting Point terms](https://www.w3.org/TR/2013/REC-prov-o-20130430/#description-starting-point-terms)) are summarised in this diagram:
<img width="1775" height="1067" alt="image" src="https://github.com/user-attachments/assets/84b520d7-3d82-4bf4-a1ef-862255d81be4" />

PROV also has a set of [Expanded Terms](https://www.w3.org/TR/2013/REC-prov-o-20130430/#description-expanded-terms), which are also quite expressible in schema.org:
<img width="1729" height="957" alt="image" src="https://github.com/user-attachments/assets/0069ebd3-febf-4f4a-a582-8adc3d2c7389" />




# Core JSON-LD/schema.org patterns for expressing provenance

As expressed in the PROV model, the core of a provenance chain comprise the things we're talking about and the things that happened to them. 

## The main Thing and its origin story

Start with the beginning and end/current point 

## Events 

Using additionType for Events

For large-scale planned actions or for unplanned events (natural formation)

recordedAt

Relationship between Events and Actions by space-time overlap and sharing of participants 

## The Actions

An Action can be many things: a sampling event, and observation event, a modelling run, an analytical routine, 
Using additionalType for Actions


## Breaking down the Actions with HowTos

Once you have an action like "sampling of deep-sea sediment"
Using additionalTypes with Actions.

SOSA actuation and changing parameters during an experiment

## Linking to Datasets and other Creative Works

Note on variable-by-variable provenance, need for variable by variable `@id`s 

# Enriching a provenance chain with context

The core chain and the decorations 

Each domain and discipline will have different requirements, but the general principle is that the metadata contextualising the provenance chain should allow understanding and reproducibility.


# Examples of common provenance patterns

Some aligned to CDIF cases 


## Sample Collection 

Both material and statistical samples, including statistical sampling from an existing dataset as well as the creation of a sample dataset from measuring material things

## Sample processing / analysis

## Observation

## Model / analytical output

With CreativeWork as source

## Data production

The start of the isBasedOn chain

## Data harvest

## Data processing
Including subsetting and reformatting / new semantic markup of data

## Data validation

## Data Analysis

## Quality and quality control
of data or other assets

Adding quality control actions and their outcomes as Claims 


Other CDIF cases to capture
Experiment
Hypothesis
Sample (material and statistical samples)
Method
Configuration
Instrument
* use sosa for the additionalType and then something like NERC SKOS for keywords?

```json
{
     "@context": {
        "@vocab": "https://schema.org/"
 },
            "@type": "Product",
            "@id": "https://urlToThisJson.org/sea-bird-SBE.json/",
            "name": "SeaTemp 5000 Sensor",
            "description": "High precision sea surface temperature sensor.",
            "manufacturer": {
              "@type": "Organization",
              "name": "SensorCorp"
            },
        "model": {
            "@type": "ProductModel",
            "identifer": "http://vocab.nerc.ac.uk/collection/L22/current/TOOL0022/",
            "name": "Sea-Bird SBE 37 MicroCat IM-CT with optional pressure (submersible) CTD sensor series"
        },
            "serialNumber": "SN-998877",
            "additionalProperty": [
              {
                "@type": "PropertyValue",
                "name": "accuracy",
                "value": "+/- 0.01 K"
              },
              {
                "@type": "PropertyValue",
                "name": "precision",
                "value": "0.005 K"
              }
            ]
            }
```


## Notes on Agents

Human, software, instrument / machine agent and their roles 

 
